{"meta":{"timestamp":"2024-11-17T18:45:42.444680","version":"7.4.0","argv":["--os","windows","-j","./samples/rootkit/e8e7f2f889948fd977b5941e6897921da28c8898a9ca1379816d9f3fa9bc40ff"],"sample":{"md5":"58df991da21c475ac135914b8315f74d","sha1":"b821b326c1855ca802ead55042657909a5f2d760","sha256":"e8e7f2f889948fd977b5941e6897921da28c8898a9ca1379816d9f3fa9bc40ff","path":"/samples/rootkit/e8e7f2f889948fd977b5941e6897921da28c8898a9ca1379816d9f3fa9bc40ff"},"flavor":"static","analysis":{"format":"pe","arch":"amd64","os":"windows","extractor":"VivisectFeatureExtractor","rules":["/tmp/_MEIBhmNGH/rules"],"base_address":{"type":"absolute","value":5368709120},"layout":{"functions":[{"address":{"type":"absolute","value":5368713216},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713216}}]},{"address":{"type":"absolute","value":5368713280},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713216}},{"address":{"type":"absolute","value":5368713310}}]},{"address":{"type":"absolute","value":5368713328},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713328}},{"address":{"type":"absolute","value":5368713552}},{"address":{"type":"absolute","value":5368713597}}]},{"address":{"type":"absolute","value":5368713632},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713328}},{"address":{"type":"absolute","value":5368713552}},{"address":{"type":"absolute","value":5368713597}},{"address":{"type":"absolute","value":5368713632}}]},{"address":{"type":"absolute","value":5368713680},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713680}},{"address":{"type":"absolute","value":5368713775}},{"address":{"type":"absolute","value":5368713788}}]},{"address":{"type":"absolute","value":5368713808},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713914}},{"address":{"type":"absolute","value":5368713925}}]},{"address":{"type":"absolute","value":5368713952},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713952}},{"address":{"type":"absolute","value":5368714031}},{"address":{"type":"absolute","value":5368714041}}]},{"address":{"type":"absolute","value":5368715340},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368715340}},{"address":{"type":"absolute","value":5368715383}}]},{"address":{"type":"absolute","value":5368715452},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368715702}},{"address":{"type":"absolute","value":5368716157}}]},{"address":{"type":"absolute","value":5368716244},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368716244}}]},{"address":{"type":"absolute","value":5368716636},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368716636}}]},{"address":{"type":"absolute","value":5368718608},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368718608}},{"address":{"type":"absolute","value":5368718633}}]},{"address":{"type":"absolute","value":5368720316},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368720316}}]},{"address":{"type":"absolute","value":5368721668},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368721668}}]},{"address":{"type":"absolute","value":5368721912},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368721977}}]},{"address":{"type":"absolute","value":5368722956},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368722956}},{"address":{"type":"absolute","value":5368722980}}]},{"address":{"type":"absolute","value":5368723056},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368723056}}]},{"address":{"type":"absolute","value":5368723240},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368723240}},{"address":{"type":"absolute","value":5368723335}}]},{"address":{"type":"absolute","value":5368723376},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368723651}},{"address":{"type":"absolute","value":5368723677}},{"address":{"type":"absolute","value":5368723698}}]},{"address":{"type":"absolute","value":5368723728},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368715388}},{"address":{"type":"absolute","value":5368715445}},{"address":{"type":"absolute","value":5368723748}},{"address":{"type":"absolute","value":5368723793}}]},{"address":{"type":"absolute","value":5368723748},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368715388}},{"address":{"type":"absolute","value":5368715445}},{"address":{"type":"absolute","value":5368723748}},{"address":{"type":"absolute","value":5368723793}}]},{"address":{"type":"absolute","value":5368723804},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368723982}}]},{"address":{"type":"absolute","value":5368724008},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368724008}},{"address":{"type":"absolute","value":5368724064}}]},{"address":{"type":"absolute","value":5368724512},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368724539}}]},{"address":{"type":"absolute","value":5368727568},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368728021}}]},{"address":{"type":"absolute","value":5368728040},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368728040}},{"address":{"type":"absolute","value":5368728073}}]},{"address":{"type":"absolute","value":5368728080},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368728080}},{"address":{"type":"absolute","value":5368728173}}]},{"address":{"type":"absolute","value":5368729388},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368729388}},{"address":{"type":"absolute","value":5368729510}}]},{"address":{"type":"absolute","value":5368729528},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368729971}},{"address":{"type":"absolute","value":5368730212}}]},{"address":{"type":"absolute","value":5368730244},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368730415}}]},{"address":{"type":"absolute","value":5368730440},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368730520}}]},{"address":{"type":"absolute","value":5368730528},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368730627}},{"address":{"type":"absolute","value":5368730768}},{"address":{"type":"absolute","value":5368730799}}]},{"address":{"type":"absolute","value":5368730916},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368731007}},{"address":{"type":"absolute","value":5368731115}}]},{"address":{"type":"absolute","value":5368731316},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368722956}},{"address":{"type":"absolute","value":5368722980}}]},{"address":{"type":"absolute","value":5368731624},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368731717}}]},{"address":{"type":"absolute","value":5368731840},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368731840}},{"address":{"type":"absolute","value":5368731925}},{"address":{"type":"absolute","value":5368731931}}]},{"address":{"type":"absolute","value":5368735048},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368735048}}]},{"address":{"type":"absolute","value":5368735096},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368735170}},{"address":{"type":"absolute","value":5368735191}}]},{"address":{"type":"absolute","value":5368735876},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368735876}},{"address":{"type":"absolute","value":5368736016}}]},{"address":{"type":"absolute","value":5368736028},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368736080}},{"address":{"type":"absolute","value":5368736153}}]},{"address":{"type":"absolute","value":5368737164},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368737285}}]},{"address":{"type":"absolute","value":5368737468},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368737468}}]},{"address":{"type":"absolute","value":5368738112},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368738144}},{"address":{"type":"absolute","value":5368738224}},{"address":{"type":"absolute","value":5368738258}},{"address":{"type":"absolute","value":5368738320}}]}]},"feature_counts":{"file":814,"functions":[{"address":{"type":"absolute","value":5368713216},"count":19},{"address":{"type":"absolute","value":5368713280},"count":23},{"address":{"type":"absolute","value":5368713328},"count":52},{"address":{"type":"absolute","value":5368713632},"count":52},{"address":{"type":"absolute","value":5368713680},"count":41},{"address":{"type":"absolute","value":5368713808},"count":48},{"address":{"type":"absolute","value":5368713952},"count":51},{"address":{"type":"absolute","value":5368715340},"count":27},{"address":{"type":"absolute","value":5368715452},"count":84},{"address":{"type":"absolute","value":5368716204},"count":20},{"address":{"type":"absolute","value":5368716244},"count":50},{"address":{"type":"absolute","value":5368716368},"count":7},{"address":{"type":"absolute","value":5368716620},"count":7},{"address":{"type":"absolute","value":5368716636},"count":23},{"address":{"type":"absolute","value":5368718608},"count":23},{"address":{"type":"absolute","value":5368720316},"count":16},{"address":{"type":"absolute","value":5368721668},"count":18},{"address":{"type":"absolute","value":5368721912},"count":31},{"address":{"type":"absolute","value":5368722956},"count":44},{"address":{"type":"absolute","value":5368723056},"count":63},{"address":{"type":"absolute","value":5368723240},"count":48},{"address":{"type":"absolute","value":5368723348},"count":7},{"address":{"type":"absolute","value":5368723376},"count":76},{"address":{"type":"absolute","value":5368723748},"count":35},{"address":{"type":"absolute","value":5368723804},"count":45},{"address":{"type":"absolute","value":5368724008},"count":29},{"address":{"type":"absolute","value":5368724512},"count":21},{"address":{"type":"absolute","value":5368727568},"count":62},{"address":{"type":"absolute","value":5368728040},"count":24},{"address":{"type":"absolute","value":5368728080},"count":43},{"address":{"type":"absolute","value":5368729388},"count":57},{"address":{"type":"absolute","value":5368729528},"count":101},{"address":{"type":"absolute","value":5368730244},"count":49},{"address":{"type":"absolute","value":5368730440},"count":22},{"address":{"type":"absolute","value":5368730528},"count":84},{"address":{"type":"absolute","value":5368730912},"count":6},{"address":{"type":"absolute","value":5368730916},"count":87},{"address":{"type":"absolute","value":5368731624},"count":24},{"address":{"type":"absolute","value":5368731840},"count":42},{"address":{"type":"absolute","value":5368735048},"count":33},{"address":{"type":"absolute","value":5368735096},"count":38},{"address":{"type":"absolute","value":5368735860},"count":15},{"address":{"type":"absolute","value":5368735876},"count":67},{"address":{"type":"absolute","value":5368736028},"count":44},{"address":{"type":"absolute","value":5368737164},"count":46},{"address":{"type":"absolute","value":5368737468},"count":21},{"address":{"type":"absolute","value":5368737497},"count":8},{"address":{"type":"absolute","value":5368737503},"count":8},{"address":{"type":"absolute","value":5368737509},"count":8},{"address":{"type":"absolute","value":5368737515},"count":8},{"address":{"type":"absolute","value":5368737521},"count":8},{"address":{"type":"absolute","value":5368737527},"count":8},{"address":{"type":"absolute","value":5368737533},"count":8},{"address":{"type":"absolute","value":5368737539},"count":8},{"address":{"type":"absolute","value":5368737545},"count":8},{"address":{"type":"absolute","value":5368737551},"count":8},{"address":{"type":"absolute","value":5368737557},"count":8},{"address":{"type":"absolute","value":5368737563},"count":8},{"address":{"type":"absolute","value":5368737569},"count":8},{"address":{"type":"absolute","value":5368737575},"count":8},{"address":{"type":"absolute","value":5368737581},"count":8},{"address":{"type":"absolute","value":5368737587},"count":8},{"address":{"type":"absolute","value":5368737593},"count":8},{"address":{"type":"absolute","value":5368737728},"count":7},{"address":{"type":"absolute","value":5368737762},"count":8},{"address":{"type":"absolute","value":5368737768},"count":8},{"address":{"type":"absolute","value":5368737792},"count":8},{"address":{"type":"absolute","value":5368737798},"count":8},{"address":{"type":"absolute","value":5368737804},"count":8},{"address":{"type":"absolute","value":5368738000},"count":8},{"address":{"type":"absolute","value":5368738016},"count":8},{"address":{"type":"absolute","value":5368738032},"count":8},{"address":{"type":"absolute","value":5368738112},"count":73},{"address":{"type":"absolute","value":5368795136},"count":25}]},"library_functions":[{"address":{"type":"absolute","value":5368723728},"name":"?AfxAbort@@YAXXZ"},{"address":{"type":"absolute","value":5368731316},"name":"?dtor$0@?0??Zero@GFP2Element@CryptoPP@@SAAEBV12@XZ@4HA"},{"address":{"type":"absolute","value":5368731328},"name":"?dtor$1@?0??Zero@GFP2Element@CryptoPP@@SAAEBV12@XZ@4HA"},{"address":{"type":"absolute","value":5368737840},"name":"__security_check_cookie"},{"address":{"type":"absolute","value":5368738064},"name":"_guard_dispatch_icall_nop"}]}},"rules":{"create thread":{"meta":{"name":"create thread","namespace":"host-interaction/thread/create","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com","joakim@intezer.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"basic block","dynamic":"thread"},"attack":[],"mbc":[{"parts":["Process","Create Thread"],"objective":"Process","behavior":"Create Thread","method":"","id":"C0038"}],"references":[],"examples":["946A99F36A46D335DEC080D9A4371940:0x10001DA0","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n","matches":[[{"type":"absolute","value":5368735048},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"pthread_create"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::Start"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthreadex"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"PsCreateSystemThread"}},"children":[],"locations":[{"type":"absolute","value":5368735080}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThreadWithHandle"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThreadEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create or open registry key":{"meta":{"name":"create or open registry key","authors":["michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Operating System","Registry","Create Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Create Registry Key","id":"C0036.004"},{"parts":["Operating System","Registry","Open Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Open Registry Key","id":"C0036.003"}],"references":[],"examples":["Practical Malware Analysis Lab 03-02.dll_:0x10004706","Practical Malware Analysis Lab 11-01.exe_:0x401000","493167E85E45363D09495D0841C30648:0x404D60","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E","692f7fd6d198e804d6af98eb9e390d61:0x6000003"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n","matches":[[{"type":"absolute","value":5368735876},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[{"type":"absolute","value":5368735983}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"delay execution":{"meta":{"name":"delay execution","authors":["michael.hunhoff@mandiant.com","@ramen0x3f"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Anti-Behavioral Analysis","Dynamic Analysis Evasion","Delayed Execution"],"objective":"Anti-Behavioral Analysis","behavior":"Dynamic Analysis Evasion","method":"Delayed Execution","id":"B0003.003"}],"references":["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions","https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"],"examples":["al-khaser_x86.exe_:0x449770","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - or:\n          - api: sleep\n          - api: usleep\n","matches":[[{"type":"absolute","value":5368736080},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[{"type":"absolute","value":5368736133}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368737468},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[{"type":"absolute","value":5368737486}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"contain loop":{"meta":{"name":"contain loop","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function"},"attack":[],"mbc":[],"references":[],"examples":["08AC667C65D36D6542917655571E61C8:0x406EAA"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n","matches":[[{"type":"absolute","value":5368713680},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":5368713680}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368713808},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":5368713808}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368713952},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":5368713952}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368722956},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":5368722956}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368731840},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":5368731840}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368735096},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":5368735096}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368738112},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":5368738160},{"type":"absolute","value":5368738320},{"type":"absolute","value":5368738258},{"type":"absolute","value":5368738198}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"register network filter via WFP API":{"meta":{"name":"register network filter via WFP API","namespace":"host-interaction/network/traffic/filter","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Impact","Data Manipulation","Transmitted Data Manipulation"],"tactic":"Impact","technique":"Data Manipulation","subtechnique":"Transmitted Data Manipulation","id":"T1565.002"}],"mbc":[],"references":[],"examples":["493167E85E45363D09495D0841C30648:0x404220"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: register network filter via WFP API\n    namespace: host-interaction/network/traffic/filter\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Impact::Data Manipulation::Transmitted Data Manipulation [T1565.002]\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x404220\n  features:\n    - and:\n      - api: fwpkclnt.FwpmFilterAdd0\n","matches":[[{"type":"absolute","value":5368729528},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"FwpmFilterAdd0"}},"children":[],"locations":[{"type":"absolute","value":5368730197}],"captures":{}}],"locations":[],"captures":{}}]]},"delete network filter via WFP API":{"meta":{"name":"delete network filter via WFP API","namespace":"host-interaction/network/traffic/filter","authors":["jakub.jozwiak@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Impact","Data Manipulation","Transmitted Data Manipulation"],"tactic":"Impact","technique":"Data Manipulation","subtechnique":"Transmitted Data Manipulation","id":"T1565.002"},{"parts":["Defense Evasion","Impair Defenses","Disable or Modify System Firewall"],"tactic":"Defense Evasion","technique":"Impair Defenses","subtechnique":"Disable or Modify System Firewall","id":"T1562.004"}],"mbc":[],"references":["https://learn.microsoft.com/en-us/windows/win32/api/fwpmu/nf-fwpmu-fwpmfilterdeletebyid0","https://learn.microsoft.com/en-us/windows/win32/api/fwpmu/nf-fwpmu-fwpmfilterdeletebykey0","https://github.com/netero1010/EDRSilencer/blob/main/EDRSilencer.c"],"examples":["d9531e53036c5d04fbe7d1aeae2988c3bf0fdec63774690c5df70cc121af8de4:0x10001DF0"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: delete network filter via WFP API\n    namespace: host-interaction/network/traffic/filter\n    authors:\n      - jakub.jozwiak@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Impact::Data Manipulation::Transmitted Data Manipulation [T1565.002]\n      - Defense Evasion::Impair Defenses::Disable or Modify System Firewall [T1562.004]\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/api/fwpmu/nf-fwpmu-fwpmfilterdeletebyid0\n      - https://learn.microsoft.com/en-us/windows/win32/api/fwpmu/nf-fwpmu-fwpmfilterdeletebykey0\n      - https://github.com/netero1010/EDRSilencer/blob/main/EDRSilencer.c\n    examples:\n      - d9531e53036c5d04fbe7d1aeae2988c3bf0fdec63774690c5df70cc121af8de4:0x10001DF0\n  features:\n    - or:\n      - api: fwpkclnt.FwpmFilterDeleteById0\n      - api: fwpkclnt.FwpmFilterDeleteByKey0\n","matches":[[{"type":"absolute","value":5368730440},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"FwpmFilterDeleteById0"}},"children":[],"locations":[{"type":"absolute","value":5368730468}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"FwpmFilterDeleteByKey0"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"set registry value":{"meta":{"name":"set registry value","namespace":"host-interaction/registry/create","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[],"mbc":[{"parts":["Operating System","Registry","Set Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Set Registry Key","id":"C0036.001"}],"references":[],"examples":["BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E","98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: set registry value\n    namespace: host-interaction/registry/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Operating System::Registry::Set Registry Key [C0036.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E\n      - 98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D\n  features:\n    - or:\n      - and:\n        - optional:\n          - match: create or open registry key\n        - or:\n          - api: advapi32.RegSetValue\n          - api: advapi32.RegSetValueEx\n          - api: advapi32.RegSetKeyValue\n          - api: ZwSetValueKey\n          - api: NtSetValueKey\n          - api: RtlWriteRegistryValue\n          - api: SHSetValue\n          - api: SHRegSetPath\n          - api: SHRegSetValue\n          - api: SHRegSetUSValue\n          - api: SHRegWriteUSValue\n          - api: Microsoft.Win32.RegistryKey::SetValue\n          - api: Microsoft.Win32.Registry::SetValue\n      - and:\n        - match: host-interaction/process/create\n        - string: \"/add/i\"\n        - or:\n          - string: \"/reg(|.exe)/i\"\n          - string: \"/hklm/i\"\n          - string: \"/HKEY_LOCAL_MACHINE/i\"\n          - string: \"/hkcu/i\"\n          - string: \"/HKEY_CURRENT_USER/i\"\n","matches":[[{"type":"absolute","value":5368737164},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"host-interaction/process/create"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/add/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/reg(|.exe)/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hklm/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_LOCAL_MACHINE/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hkcu/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_CURRENT_USER/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValueEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetKeyValue"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"ZwSetValueKey"}},"children":[],"locations":[{"type":"absolute","value":5368737248}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlWriteRegistryValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegWriteUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::SetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.Registry::SetValue"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"contains PDB path":{"meta":{"name":"contains PDB path","namespace":"executable/pe/pdb","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[],"mbc":[],"references":[],"examples":["464EF2CA59782CE697BC329713698CCC"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/:\\\\.*\\.pdb/"}},"children":[],"locations":[{"type":"file","value":30480}],"captures":{"C:\\Users\\omen\\source\\repos\\netfilterdrv\\x64\\Release\\netfilterdrv.pdb":[{"type":"file","value":30480}]}}]]}}}
